# 宠物管理系统 - 安装使用指南

## 目录
- [系统要求](#系统要求)
- [安装步骤](#安装步骤)
- [配置说明](#配置说明)
- [功能使用](#功能使用)
- [常见问题](#常见问题)
- [维护指南](#维护指南)

## 系统要求

### 最低配置要求
- **操作系统**: Windows 10/11, macOS 10.15+, Ubuntu 18.04+
- **PHP版本**: 7.4 或更高版本
- **MySQL版本**: 5.7 或更高版本
- **Web服务器**: Apache 2.4+ 或 Nginx 1.18+
- **内存**: 最少 2GB RAM
- **存储空间**: 最少 5GB 可用空间

### 推荐配置
- **PHP版本**: 8.0+
- **MySQL版本**: 8.0+
- **内存**: 4GB+ RAM
- **存储空间**: 20GB+ SSD
- **网络**: 稳定的互联网连接

### 必需的PHP扩展
```bash
# 检查PHP扩展
php -m | grep -E "(mysqli|pdo|gd|curl|zip|xml|mbstring|json)"
```

必需扩展列表：
- `mysqli` - MySQL数据库连接
- `pdo` - 数据库抽象层
- `gd` - 图像处理
- `curl` - HTTP请求
- `zip` - 文件压缩
- `xml` - XML处理
- `mbstring` - 多字节字符串
- `json` - JSON处理

## 安装步骤

### 方式一：手动安装

#### 1. 下载项目文件
```bash
# 使用Git克隆
git clone [项目仓库地址] chongwu
cd chongwu

# 或下载ZIP文件并解压
wget [项目下载链接]
unzip chongwu-main.zip
cd chongwu-main
```

#### 2. 配置Web服务器

**Apache配置**
```apache
# 在 /etc/apache2/sites-available/ 创建配置文件
<VirtualHost *:80>
    ServerName localhost
    DocumentRoot /var/www/html/chongwu/frontend
    
    <Directory /var/www/html/chongwu/frontend>
        AllowOverride All
        Require all granted
    </Directory>
    
    ErrorLog ${APACHE_LOG_DIR}/chongwu_error.log
    CustomLog ${APACHE_LOG_DIR}/chongwu_access.log combined
</VirtualHost>
```

**Nginx配置**
```nginx
# 在 /etc/nginx/sites-available/ 创建配置文件
server {
    listen 80;
    server_name localhost;
    root /var/www/html/chongwu/frontend;
    index index.php index.html;
    
    location / {
        try_files $uri $uri/ /index.php?$args;
    }
    
    location ~ \.php$ {
        fastcgi_pass unix:/var/run/php/php8.0-fpm.sock;
        fastcgi_index index.php;
        include fastcgi_params;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
    }
    
    location ~ /\.ht {
        deny all;
    }
}
```

#### 3. 创建数据库
```sql
-- 登录MySQL
mysql -u root -p

-- 创建数据库
CREATE DATABASE pet_management_system CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- 创建用户（可选）
CREATE USER 'petuser'@'localhost' IDENTIFIED BY 'secure_password';
GRANT ALL PRIVILEGES ON pet_management_system.* TO 'petuser'@'localhost';
FLUSH PRIVILEGES;

-- 退出MySQL
EXIT;
```

#### 4. 配置WordPress
```bash
# 复制配置文件模板
cp frontend/wp-config-sample.php frontend/wp-config.php

# 编辑配置文件
nano frontend/wp-config.php
```

在 `wp-config.php` 中修改以下配置：
```php
// 数据库配置
define('DB_NAME', 'pet_management_system');
define('DB_USER', 'petuser');
define('DB_PASSWORD', 'secure_password');
define('DB_HOST', 'localhost');
define('DB_CHARSET', 'utf8mb4');

// 安全密钥（访问 https://api.wordpress.org/secret-key/1.1/salt/ 获取）
define('AUTH_KEY',         '在此处粘贴密钥');
define('SECURE_AUTH_KEY',  '在此处粘贴密钥');
// ... 其他密钥

// 调试模式（生产环境设为false）
define('WP_DEBUG', true);
define('WP_DEBUG_LOG', true);
define('WP_DEBUG_DISPLAY', false);
```

#### 5. 设置文件权限
```bash
# 设置所有者
sudo chown -R www-data:www-data /var/www/html/chongwu/

# 设置目录权限
find /var/www/html/chongwu/ -type d -exec chmod 755 {} \;

# 设置文件权限
find /var/www/html/chongwu/ -type f -exec chmod 644 {} \;

# 设置wp-config.php权限
chmod 600 /var/www/html/chongwu/frontend/wp-config.php
```

#### 6. 启动服务
```bash
# 启动Apache
sudo systemctl start apache2
sudo systemctl enable apache2

# 或启动Nginx + PHP-FPM
sudo systemctl start nginx
sudo systemctl start php8.0-fpm
sudo systemctl enable nginx
sudo systemctl enable php8.0-fpm
```

### 方式二：Docker安装

#### 1. 创建Docker配置文件

**Dockerfile**
```dockerfile
FROM wordpress:latest

# 安装额外的PHP扩展
RUN docker-php-ext-install mysqli pdo pdo_mysql

# 复制自定义配置
COPY ./frontend /var/www/html/

# 设置权限
RUN chown -R www-data:www-data /var/www/html
```

**docker-compose.yml**
```yaml
version: '3.8'

services:
  wordpress:
    build: .
    ports:
      - "8080:80"
    environment:
      WORDPRESS_DB_HOST: db
      WORDPRESS_DB_USER: petuser
      WORDPRESS_DB_PASSWORD: secure_password
      WORDPRESS_DB_NAME: pet_management_system
    volumes:
      - ./frontend:/var/www/html
    depends_on:
      - db

  db:
    image: mysql:8.0
    environment:
      MYSQL_DATABASE: pet_management_system
      MYSQL_USER: petuser
      MYSQL_PASSWORD: secure_password
      MYSQL_ROOT_PASSWORD: root_password
    volumes:
      - db_data:/var/lib/mysql
      - ./db_backups:/docker-entrypoint-initdb.d

volumes:
  db_data:
```

#### 2. 启动Docker容器
```bash
# 构建并启动容器
docker-compose up -d

# 查看容器状态
docker-compose ps

# 查看日志
docker-compose logs -f
```

## 配置说明

### WordPress基本配置

#### 1. 完成WordPress安装
1. 访问 `http://localhost:8080`
2. 选择语言（中文）
3. 填写网站信息：
   - 网站标题：宠物管理系统
   - 用户名：admin
   - 密码：设置强密码
   - 邮箱：管理员邮箱

#### 2. 安装必需插件
```bash
# 通过WP-CLI安装插件（可选）
wp plugin install woocommerce --activate
wp plugin install elementor --activate
wp plugin install contact-form-7 --activate
```

或通过管理后台安装：
1. 登录 `http://localhost:8080/wp-admin`
2. 插件 → 安装插件
3. 搜索并安装：
   - WooCommerce（电商功能）
   - Elementor（页面构建器）
   - Contact Form 7（联系表单）

#### 3. 主题配置
1. 外观 → 主题
2. 激活 Gopet 主题
3. 外观 → 自定义
4. 配置网站标识、颜色、布局等

### WooCommerce配置

#### 1. 基本设置
1. WooCommerce → 设置
2. 常规设置：
   - 商店地址：填写实际地址
   - 货币：人民币 (CNY)
   - 货币位置：符号在前

#### 2. 产品设置
1. 产品 → 分类
2. 创建产品分类：
   - 宠物食品
   - 宠物用品
   - 宠物玩具
   - 医疗用品

#### 3. 支付设置
1. WooCommerce → 设置 → 支付
2. 启用支付方式：
   - 银行转账
   - 货到付款
   - 支付宝（需安装插件）
   - 微信支付（需安装插件）

#### 4. 配送设置
1. WooCommerce → 设置 → 配送
2. 配置配送区域和费率
3. 设置免费配送条件

## 功能使用

### 管理员功能

#### 1. 用户管理
```
路径：用户 → 所有用户
功能：
- 查看用户列表
- 编辑用户信息
- 设置用户角色
- 批量操作用户
```

#### 2. 产品管理
```
路径：产品 → 所有产品
功能：
- 添加新产品
- 编辑产品信息
- 设置产品价格
- 管理库存
- 产品分类管理
```

#### 3. 订单管理
```
路径：WooCommerce → 订单
功能：
- 查看订单列表
- 处理订单状态
- 打印订单详情
- 退款处理
```

#### 4. 数据统计
```
路径：WooCommerce → 报告
功能：
- 销售报告
- 产品报告
- 用户报告
- 库存报告
```

### 用户功能

#### 1. 账户注册
1. 访问网站首页
2. 点击"注册"按钮
3. 填写注册信息：
   - 用户名
   - 邮箱地址
   - 密码
   - 确认密码
4. 验证邮箱（如启用）
5. 完善个人资料

#### 2. 宠物信息管理
1. 登录账户
2. 进入"我的账户"
3. 选择"宠物管理"
4. 添加宠物信息：
   - 宠物姓名
   - 品种
   - 年龄
   - 性别
   - 健康状况
   - 上传照片

#### 3. 商品购买流程
1. 浏览产品分类
2. 查看产品详情
3. 选择规格和数量
4. 添加到购物车
5. 查看购物车
6. 填写配送信息
7. 选择支付方式
8. 确认订单
9. 完成支付

#### 4. 服务预约
1. 选择服务类型：
   - 宠物医疗
   - 美容服务
   - 寄养服务
   - 训练课程
2. 选择服务提供商
3. 选择时间段
4. 填写宠物信息
5. 确认预约
6. 支付定金

### 移动端使用

#### 响应式设计
- 自动适配手机屏幕
- 触摸友好的界面
- 简化的导航菜单
- 优化的表单输入

#### 移动端特色功能
- 一键拨打客服电话
- GPS定位附近服务
- 扫码快速登录
- 推送通知提醒

## 常见问题

### 安装问题

**Q: 数据库连接失败**
```
A: 检查以下项目：
1. 数据库服务是否启动
2. 数据库配置信息是否正确
3. 用户权限是否足够
4. 防火墙是否阻止连接
```

**Q: 页面显示空白**
```
A: 解决方法：
1. 检查PHP错误日志
2. 确认文件权限设置
3. 验证.htaccess文件
4. 检查内存限制设置
```

**Q: 插件无法激活**
```
A: 可能原因：
1. PHP版本不兼容
2. 缺少必需的PHP扩展
3. 文件权限问题
4. 内存不足
```

### 使用问题

**Q: 无法上传图片**
```
A: 检查项目：
1. upload目录权限
2. PHP上传限制
3. 文件大小限制
4. 文件类型限制
```

**Q: 邮件发送失败**
```
A: 配置SMTP：
1. 安装SMTP插件
2. 配置邮件服务器
3. 测试邮件发送
4. 检查防火墙设置
```

**Q: 支付功能异常**
```
A: 排查步骤：
1. 检查支付插件配置
2. 验证API密钥
3. 测试支付接口
4. 查看错误日志
```

### 性能问题

**Q: 网站加载缓慢**
```
A: 优化方法：
1. 启用缓存插件
2. 优化图片大小
3. 压缩CSS/JS文件
4. 使用CDN服务
5. 升级服务器配置
```

**Q: 数据库查询慢**
```
A: 优化建议：
1. 添加数据库索引
2. 优化查询语句
3. 清理无用数据
4. 升级MySQL版本
```

## 维护指南

### 日常维护

#### 1. 备份管理
```bash
# 数据库备份
mysqldump -u root -p pet_management_system > backup_$(date +%Y%m%d).sql

# 文件备份
tar -czf website_backup_$(date +%Y%m%d).tar.gz /var/www/html/chongwu/

# 自动备份脚本
#!/bin/bash
BACKUP_DIR="/var/backups/chongwu"
DATE=$(date +%Y%m%d_%H%M%S)

# 创建备份目录
mkdir -p $BACKUP_DIR

# 数据库备份
mysqldump -u root -p pet_management_system > $BACKUP_DIR/db_$DATE.sql

# 文件备份
tar -czf $BACKUP_DIR/files_$DATE.tar.gz /var/www/html/chongwu/

# 删除7天前的备份
find $BACKUP_DIR -name "*.sql" -mtime +7 -delete
find $BACKUP_DIR -name "*.tar.gz" -mtime +7 -delete
```

#### 2. 更新管理
```bash
# WordPress核心更新
wp core update

# 插件更新
wp plugin update --all

# 主题更新
wp theme update --all

# 检查更新
wp core check-update
wp plugin list --update=available
wp theme list --update=available
```

#### 3. 安全检查
```bash
# 检查文件权限
find /var/www/html/chongwu/ -type f -perm 777
find /var/www/html/chongwu/ -type d -perm 777

# 检查可疑文件
find /var/www/html/chongwu/ -name "*.php" -exec grep -l "eval\|base64_decode" {} \;

# 检查用户权限
wp user list --role=administrator
```

#### 4. 性能监控
```bash
# 检查磁盘使用
df -h

# 检查内存使用
free -h

# 检查CPU使用
top

# 检查网站响应时间
curl -o /dev/null -s -w "%{time_total}\n" http://localhost:8080
```

### 故障处理

#### 1. 网站无法访问
```bash
# 检查Web服务器状态
sudo systemctl status apache2
# 或
sudo systemctl status nginx

# 检查PHP-FPM状态
sudo systemctl status php8.0-fpm

# 重启服务
sudo systemctl restart apache2
sudo systemctl restart php8.0-fpm
```

#### 2. 数据库连接问题
```bash
# 检查MySQL状态
sudo systemctl status mysql

# 重启MySQL
sudo systemctl restart mysql

# 检查连接
mysql -u petuser -p pet_management_system
```

#### 3. 恢复备份
```bash
# 恢复数据库
mysql -u root -p pet_management_system < backup_20241201.sql

# 恢复文件
tar -xzf website_backup_20241201.tar.gz -C /
```

### 升级指南

#### 1. 升级前准备
1. 完整备份网站和数据库
2. 在测试环境验证升级
3. 通知用户维护时间
4. 准备回滚方案

#### 2. 升级步骤
1. 进入维护模式
2. 更新WordPress核心
3. 更新插件和主题
4. 测试核心功能
5. 退出维护模式

#### 3. 升级后检查
1. 验证网站功能正常
2. 检查错误日志
3. 测试支付流程
4. 确认邮件发送
5. 性能测试

---

**技术支持**: 如遇到问题，请查看错误日志或联系技术支持团队  
**文档版本**: v1.0  
**最后更新**: 2024年12月