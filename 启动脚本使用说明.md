# 猫砂管理系统 - 启动脚本使用说明

## 📋 脚本列表

### 1. 启动所有服务.bat (推荐)
**Windows批处理脚本，双击即可运行**

**功能：**
- ✅ 自动检查MySQL和Redis服务状态
- ✅ 测试数据库连接
- ✅ 启动后端API服务 (端口3000)
- ✅ 启动后台管理界面 (端口80)
- ✅ 启动前端网站 (端口8080)
- ✅ 自动打开所有页面到浏览器

**使用方法：**
```
双击 "启动所有服务.bat" 文件
```

---

### 2. 启动所有服务.ps1
**PowerShell脚本，功能更强大，带彩色输出**

**功能：**
- ✅ 所有 .bat 脚本的功能
- ✅ 彩色控制台输出
- ✅ 更详细的状态信息
- ✅ 更好的错误处理

**使用方法：**

**方式1：右键运行**
```
右键点击 "启动所有服务.ps1" → 选择 "使用PowerShell运行"
```

**方式2：命令行运行**
```powershell
powershell -ExecutionPolicy Bypass -File "启动所有服务.ps1"
```

**注意：** 如果提示"无法加载，因为在此系统上禁止运行脚本"，请以管理员身份运行PowerShell并执行：
```powershell
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
```

---

### 3. 停止所有服务.bat
**快速停止所有运行中的服务**

**功能：**
- ✅ 停止所有Node.js进程
- ✅ 停止npm进程
- ✅ 关闭服务窗口

**使用方法：**
```
双击 "停止所有服务.bat" 文件
```

**注意：** 此脚本不会停止MySQL和Redis服务

---

## 🚀 快速开始

### 第一次使用

1. **确保已安装所有依赖**
   ```bash
   # 后端API依赖
   cd backend/meimei-prisma-vue3/meimei-admin
   npm install
   
   # 后台管理界面依赖
   cd backend/meimei-prisma-vue3/meimei-ui-vue3
   npm install
   ```

2. **确保MySQL和Redis服务已启动**
   - MySQL服务名：MySQL84
   - Redis需要手动启动

3. **运行启动脚本**
   ```
   双击 "启动所有服务.bat"
   ```

4. **等待所有服务启动完成**
   - 后端API：约15秒
   - 后台管理：约10秒
   - 前端网站：约5秒

5. **浏览器会自动打开以下页面**
   - 前端网站：http://localhost:8080
   - 后台管理：http://localhost:80
   - 后端API：http://localhost:3000

---

## 🔐 登录信息

### 后台管理系统
- **访问地址：** http://localhost:80
- **用户名：** admin
- **密码：** admin123

### 数据库连接
- **主机：** 127.0.0.1
- **端口：** 3306
- **数据库：** meimei-prisma
- **用户名：** maosha
- **密码：** 123456

---

## 📊 服务端口说明

| 服务 | 端口 | 访问地址 | 说明 |
|------|------|----------|------|
| 前端网站 | 8080 | http://localhost:8080 | 猫砂电商网站前台 |
| 后台管理 | 80 | http://localhost:80 | Vue3管理后台界面 |
| 后端API | 3000 | http://localhost:3000 | NestJS后端服务 |
| MySQL | 3306 | 127.0.0.1:3306 | 数据库服务 |
| Redis | 6379 | localhost:6379 | 缓存服务 |

---

## ⚠️ 常见问题

### 1. 端口被占用
**问题：** 启动时提示端口已被占用

**解决方法：**
```bash
# 查看端口占用情况
netstat -ano | findstr :3000
netstat -ano | findstr :80
netstat -ano | findstr :8080

# 结束占用端口的进程
taskkill /F /PID <进程ID>
```

### 2. MySQL服务未启动
**问题：** 脚本提示MySQL服务未运行

**解决方法：**
```bash
# 方式1：使用脚本（需要管理员权限）
net start MySQL84

# 方式2：使用服务管理器
services.msc → 找到MySQL84 → 启动
```

### 3. Redis服务未启动
**问题：** 后端API无法连接Redis

**解决方法：**
```bash
# 找到Redis安装目录，运行
redis-server.exe
```

### 4. npm依赖未安装
**问题：** 服务启动失败，提示找不到模块

**解决方法：**
```bash
# 在对应目录下运行
npm install
```

### 5. 数据库连接失败
**问题：** 提示数据库连接失败

**检查清单：**
- [ ] MySQL服务是否运行
- [ ] 数据库 meimei-prisma 是否存在
- [ ] 用户名密码是否正确 (maosha/123456)
- [ ] .env 文件中的数据库配置是否正确

---

## 🛠️ 手动启动服务

如果自动脚本无法使用，可以手动启动：

### 1. 启动后端API
```bash
cd backend/meimei-prisma-vue3/meimei-admin
npm run start:dev
```

### 2. 启动后台管理
```bash
cd backend/meimei-prisma-vue3/meimei-ui-vue3
npm run dev
```

### 3. 启动前端网站
```bash
node server.js
```

---

## 📝 脚本工作流程

```
启动脚本执行流程：
├── 1. 检查MySQL服务状态
│   └── 如果未运行，尝试启动
├── 2. 检查Redis服务状态
│   └── 如果未运行，显示警告
├── 3. 测试数据库连接
│   └── 执行测试查询
├── 4. 启动后端API服务
│   ├── 打开新窗口
│   ├── 切换到后端目录
│   └── 执行 npm run start:dev
├── 5. 启动后台管理界面
│   ├── 打开新窗口
│   ├── 切换到管理界面目录
│   └── 执行 npm run dev
├── 6. 启动前端网站
│   ├── 打开新窗口
│   └── 执行 node server.js
└── 7. 打开浏览器页面
    ├── http://localhost:8080
    ├── http://localhost:80
    └── http://localhost:3000
```

---

## 💡 使用建议

1. **推荐使用 .bat 脚本**
   - 双击即可运行，无需额外配置
   - 兼容性最好

2. **开发时保持服务窗口打开**
   - 可以实时查看日志
   - 方便调试错误

3. **关闭服务**
   - 使用 "停止所有服务.bat"
   - 或直接关闭服务窗口

4. **定期检查服务状态**
   - 确保MySQL和Redis服务正常运行
   - 检查端口是否被占用

---

## 📞 技术支持

如有问题，请检查：
1. 所有依赖是否已安装 (npm install)
2. MySQL和Redis服务是否运行
3. 端口是否被占用
4. .env 配置文件是否正确

---

**祝使用愉快！🎉**

